Рутокен M2M SDK

I. Общее описание

Рутокен M2M SDK состоит из демонстрационной платы Рутокен 4990, подключенной к компьютеру Raspberry Pi 2. На Raspberry Pi 2 установлена операционная система Linux с настроенным программным обеспечением, обеспечивающим возможность взаимодействия со смарт-картами, и предустановленными примерами взаимодействия со смарт-картами Рутокен, размещенными на демонстрационной плате.

II. Встроенные на демонстрационную плату модули

На демонстрационной плате Рутокен 4990 установлены три встроенных модуля:
    1. Рутокен 2010
        Это модуль типа "System on Chip" (SoC). Взаимодействие с модулем осуществляется по USB. USB-контакты модуля выведены на внешний USB-порт демонстрационной платы, помеченный как "USB 2010". Для того, чтобы подключить Рутокен 2010 к Raspberry Pi 2, необходимо использовать внешний USB-кабель. 
    2. Рутокен 4010
        Это модуль типа "System on module" (SOM). Взаимодействие с модулем осуществляется по последовательному интерфейсу. Модуль подключен к GPIO-контактам Raspberry Pi 2.
    3. Устройство чтения micro-SIM-карт.
        Этот модуль предназначен для подключения в него смарт-карт Рутокен 2151 и Рутокен 2100 в формате micro-SIM. Сам модуль не является активным устройством; управление подключенными в него смарт-картами производится специальным драйвером операционной системы. В текущей версии Рутокен M2M SDK взаимодействие с данным модулем не поддерживается.

III. Специализированное программное обеспечение

В операционную систему на компьютере Raspberry Pi 2 установлены дополнительные программные пакеты, предназначенные для взаимодействия со смарт-картами. Пакет pcsclite реализует PC/SC-интерфейс, который используется общесистемным ПО для доступа к смарт-картам. Для взаимодействия с Рутокен 2010 pcsclite задействует CCID-драйвер. Взаимодействие с Рутокен 4010 производится с использованием rtuart-драйвера. Взаимодействие со смарт-картами может осуществляться при помощи утилит из установленных пакетов OpenSC и pcsc-tools. Для работы программ, использующие PKCS#11-интерфейс для взаимодействия со смарт-картами, установлена библиотека librtpkcs11ecp.so.

IV. Примеры Рутокен SDK 

В поддиректории `sdk` домашней директории пользователя содержатся скомпилированные примеры из Рутокен SDK. В них выполняются типичные задачи по взаимодействию со смарт-картами с использованием интерфейсов PKCS#11 и OpenSSL. Исходный код примеров доступен в Рутокен SDK, который можно скачать по ссылке: https://www.rutoken.ru/developers/sdk/.

V. Утилиты M2M SDK

Для удобства управления модулями, размещенными на демонстрационной плате, в операционную систему добавлены специальные утилиты.

    1. Утилита rt-control используется для управления подачей питания к смарт-картам и запуском системного ПО, обеспечивающего взаимодействие со смарт-картами. С помощью этой утилиты можно включить и выключить питание каждого из модулей демонстрационной платы, запустить, остановить и перезапустить pcscd, включить и отключить логирование pcscd и драйверов смарт-карт. Данная утилита также используется для просмотра текущего состояния контролируемых объектов.
    2. Утилита rt-run-sample позволяет запустить заданное приложение с включенным логированием обращений к PC/SC-интерфейсу (для логирования используется pcsc-spy). При запуске приложения утилита также позволяет указать, какие из модулей демонстрационной платы должны быть включены.
    3. Утилита rt-uart-test позволяет запустить приложение rtuart_transport_test, распространяемое в пакете rtuart. В зависимости от режима работы, утилита либо конфигурирует программное окружение, чтобы обеспечить возможность запуска приложения, либо проверяет возможность запуска приложения, и после этого запускает rtuart_transport_test.

Все утилиты при указании опции `-h` позволяют получить справочное сообщение. Подробная информация об утилитах размещена в файле `/opt/Rutoken/m2m-utils/doc/README.md`.

VI. Соблюдение лицензий

Дистрибутив распространяемой в составе Рутокен M2M SDK операционной системы собран с использованием проекта Buildroot. В дистрибутиве содержится программное обеспечение с открытым исходным кодом (загрузчики, ядро, библиотеки, программы), распространяемые под различными лицензиями. Проект Buildroot распространяется по лицензии GNU General Public License, версии 2. Текст лицензии и исходный код, использованный для создания данного дистрибутива, размещен на отдельном разделе SD-карты, с которой в настоящий момент запущена операционная система. По умолчанию этот раздел примонтирован по пути `/buildroot`. Исходный код программных пакетов в составе дистрибутива и лицензии этих пакетов могут быть найдены по пути `/buildroot/legal-info`.
